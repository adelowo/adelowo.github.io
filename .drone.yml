kind: pipeline
name: default

steps:
- name: build
  image: ruby:latest
  commands:
    - gem update --system
    - gem install bundler
    - bundle install
    - bundle exec jekyll build

- name: deploy
  image: drillster/drone-rsync
  environment:
    RSYNC_KEY:
      from_secret: rsync_key
  settings:
    hosts: [ "lanre.wtf" ]
    source: _site/*
    target: /root/lanre.wtf
    recursive: true
    delete: true
    when:
      event: [ push, tag ]
      local: false


trigger:
  branch: master
  event: [push, pull_request,tag]
